{"version":3,"file":"main.js","mappings":"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","sources":["webpack://ahj-chat-frontend/webpack/bootstrap","webpack://ahj-chat-frontend/webpack/runtime/publicPath","webpack://ahj-chat-frontend/./src/js/Chat.js","webpack://ahj-chat-frontend/./src/js/getCreationDate.js","webpack://ahj-chat-frontend/./src/js/Tooltip.js","webpack://ahj-chat-frontend/./src/js/RenderModal.js","webpack://ahj-chat-frontend/./src/img/cell.jpg","webpack://ahj-chat-frontend/./src/js/app.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.p = \"\";","import getCreationDate from './getCreationDate';\n\nexport default class Chat {\n  constructor(container, activeUser) {\n    this.container = container;\n    this.activeUser = activeUser;\n  }\n\n  renderConnectionUser(user) {\n    const connectionContainer = document.querySelector('.connection-container');\n\n    const connectionRow = document.createElement('UL');\n    const liPreview = document.createElement('LI');\n    const connectionPreview = document.createElement('DIV');\n    const liUser = document.createElement('LI');\n    const connectionUser = document.createElement('P');\n\n    connectionRow.classList.add('connection-row');\n    connectionPreview.classList.add('connection-prewiew');\n    connectionUser.classList.add('connection-user');\n\n    if (user === this.activeUser) {\n      connectionUser.classList.add('you');\n      connectionUser.textContent = `${user} (You)`;\n\n      window.onbeforeunload = async () => {\n        const query = `subscriptions/${encodeURIComponent(this.activeUser)}`;\n\n        fetch(`https://chat-backendnew.onrender.com/${query}`, {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n      };\n    } else {\n      connectionUser.textContent = user;\n    }\n\n    connectionContainer.appendChild(connectionRow);\n    connectionRow.append(liPreview);\n    liPreview.append(connectionPreview);\n    connectionRow.append(liUser);\n    liUser.append(connectionUser);\n  }\n\n  static removeDisconnectionUser(user) {\n    const connectionUserArray = Array.from(document.querySelectorAll('.connection-user'));\n\n    const removeUser = connectionUserArray.find((item) => item.textContent === user);\n\n    removeUser.closest('.connection-row').remove();\n  }\n\n  async renderChat() {\n    const connectionContainer = document.createElement('DIV');\n\n    const chatContainer = document.createElement('DIV');\n    const chat = document.createElement('DIV');\n    const chatSend = document.createElement('FORM');\n    const chatMessage = document.createElement('INPUT');\n\n    chatContainer.classList.add('chat-container');\n    chat.classList.add('chat');\n    chatSend.classList.add('chat-send');\n    chatMessage.classList.add('chat-message');\n\n    chatMessage.placeholder = 'Type some text';\n\n    this.container.appendChild(chatContainer);\n    chatContainer.append(chat);\n    chatSend.append(chatMessage);\n    chatContainer.append(chatSend);\n\n    connectionContainer.classList.add('connection-container');\n    this.container.appendChild(connectionContainer);\n\n    this.messaging();\n\n    const request = fetch('https://chat-backendnew.onrender.com/index/', {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n    const result = await request;\n\n    if (!result.ok) {\n      console.error('Ошибка');\n\n      return;\n    }\n\n    const json = await result.json();\n\n    if (json) {\n      json.forEach((item) => {\n        this.renderConnectionUser(item.nickname);\n      });\n    }\n\n    this.gettingUsers();\n  }\n\n  renderMessage(autor, text) {\n    const chat = document.querySelector('.chat');\n    const boxMessage = document.createElement('DIV');\n    const information = document.createElement('SPAN');\n    const message = document.createElement('P');\n\n    boxMessage.classList.add('message-container');\n    information.classList.add('message-information');\n    message.classList.add('message-text');\n\n    const dateCreate = getCreationDate();\n\n    if (autor === this.activeUser) {\n      boxMessage.classList.add('right-align');\n      information.classList.add('you-message');\n      information.textContent = `${autor} (You), ${dateCreate}`;\n      message.textContent = text;\n    } else {\n      information.textContent = `${autor}, ${dateCreate}`;\n      message.textContent = text;\n    }\n\n    chat.appendChild(boxMessage);\n    boxMessage.append(information);\n    boxMessage.append(message);\n  }\n\n  gettingUsers() {\n    const eventSource = new EventSource('https://chat-backendnew.onrender.com/sse');\n\n    eventSource.addEventListener('open', (e) => {\n      console.log(e);\n\n      console.log('sse open');\n    });\n\n    eventSource.addEventListener('error', (e) => {\n      console.log(e);\n\n      console.log('sse error');\n    });\n\n    eventSource.addEventListener('message', (e) => {\n      console.log(e);\n      console.log(e.data);\n      const { nickname, req } = JSON.parse(e.data);\n\n      if (req === 'add') {\n        this.renderConnectionUser(nickname);\n      }\n      if (req === 'remove') {\n        Chat.removeDisconnectionUser(nickname);\n      }\n\n      console.log('sse message');\n    });\n  }\n\n  messaging() {\n    const ws = new WebSocket('wss://chat-backendnew.onrender.com/ws');\n\n    const chatMessage = document.querySelector('.chat-message');\n    const chatSend = document.querySelector('.chat-send');\n\n    chatSend.addEventListener('submit', (e) => {\n      e.preventDefault();\n\n      const message = {};\n\n      message.autor = this.activeUser;\n      message.text = chatMessage.value;\n\n      if (!message) return;\n\n      ws.send(JSON.stringify(message));\n\n      chatMessage.value = '';\n    });\n\n    ws.addEventListener('open', (e) => {\n      console.log(e);\n\n      console.log('ws open');\n    });\n\n    ws.addEventListener('close', (e) => {\n      console.log(e);\n\n      console.log('ws close');\n    });\n\n    ws.addEventListener('error', (e) => {\n      console.log(e);\n\n      console.log('ws error');\n    });\n\n    ws.addEventListener('message', (e) => {\n      const data = JSON.parse(e.data);\n      const { chat: messages } = data;\n\n      messages.forEach((message) => {\n        const { autor } = JSON.parse(message);\n        const { text } = JSON.parse(message);\n\n        this.renderMessage(autor, text);\n      });\n\n      console.log('ws message');\n    });\n  }\n}\n","export default function getCreationDate() {\n  const date = new Date();\n  let dateHours = date.getHours();\n  let dateMinutes = date.getMinutes();\n  let dateDay = date.getDate();\n  let dateMonth = date.getMonth() + 1;\n  if (dateHours < 10) {\n    dateHours = `0${dateHours}`;\n  }\n  if (dateMinutes < 10) {\n    dateMinutes = `0${dateMinutes}`;\n  }\n  if (dateDay < 10) {\n    dateDay = `0${dateDay}`;\n  }\n  if (dateMonth < 10) {\n    dateMonth = `0${dateMonth}`;\n  }\n  return `${dateHours}:${dateMinutes} ${dateDay}.${dateMonth}.${date.getFullYear()}`;\n}\n","export default class Tooltip {\n  constructor() {\n    this._tooltips = [];\n  }\n\n  showTooltip(message, element) {\n    const tooltipElement = document.createElement('DIV');\n\n    tooltipElement.classList.add('form-error');\n    tooltipElement.textContent = message;\n\n    const id = performance.now();\n\n    this._tooltips.push({\n      id,\n      element: tooltipElement,\n    });\n\n    document.body.appendChild(tooltipElement);\n\n    const { right, top } = element.getBoundingClientRect();\n\n    tooltipElement.style.left = `${right + 5}px`;\n    tooltipElement.style.top = `${top + element.offsetHeight / 2 - tooltipElement.offsetHeight / 2}px`;\n    return id;\n  }\n\n  removeTooltip(id) {\n    const tooltip = this._tooltips.find((t) => t.id === id);\n\n    if (tooltip) {\n      tooltip.element.remove();\n    }\n\n    this._tooltips = this._tooltips.filter((t) => t.id !== id);\n  }\n\n  removeAllTooltip() {\n    this._tooltips.forEach((item) => item.element.remove());\n    this._tooltips = [];\n  }\n}\n","import Chat from './Chat';\nimport Tooltip from './Tooltip';\n\nexport default class RenderModal {\n  constructor(container) {\n    this.container = container;\n    this.tooltipFactory = new Tooltip();\n  }\n\n  enterUser() {\n    const modalContainer = document.createElement('DIV');\n    const titleModal = document.createElement('H1');\n    const formModal = document.createElement('FORM');\n    const inputModal = document.createElement('INPUT');\n    const buttonModal = document.createElement('BUTTON');\n\n    modalContainer.classList.add('modal-container');\n    titleModal.classList.add('modal-title');\n    formModal.classList.add('modal-form');\n    inputModal.classList.add('modal-input');\n    buttonModal.classList.add('modal-button');\n\n    formModal.setAttribute('novalidate', true);\n    inputModal.setAttribute('required', true);\n    inputModal.name = 'nickname';\n    inputModal.setCustomValidity('');\n\n    titleModal.textContent = 'Выберите псевдоним';\n    buttonModal.textContent = 'Продолжить';\n\n    this.container.appendChild(modalContainer);\n    modalContainer.append(titleModal);\n    formModal.append(inputModal);\n    formModal.append(buttonModal);\n    modalContainer.append(formModal);\n\n    let actualMessages = [];\n\n    const showTooltip = (message, el) => {\n      actualMessages.push({\n        name: el.name,\n        id: this.tooltipFactory.showTooltip(message, el),\n      });\n    };\n\n    formModal.addEventListener('submit', async (e) => {\n      e.preventDefault();\n\n      actualMessages.forEach((message) => this.tooltipFactory.removeTooltip(message.id));\n      actualMessages = [];\n\n      let request; let result; let\n        json;\n\n      request = fetch('https://chat-backendnew.onrender.com/index/', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      RenderModal.generationLoading(modalContainer);\n\n      result = await request;\n\n      if (!result.ok) {\n        console.error('Ошибка');\n\n        return;\n      }\n\n      json = await result.json();\n\n      if (json) {\n        json.forEach((item) => {\n          if (item.nickname === inputModal.value) {\n            inputModal.setCustomValidity('customError');\n          } else {\n            inputModal.setCustomValidity('');\n          }\n        });\n      }\n\n      if (formModal.checkValidity()) {\n        const nickname = inputModal.value;\n\n        const chat = new Chat(this.container, nickname);\n\n        request = fetch('https://chat-backendnew.onrender.com/subscriptions/', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ nickname }),\n        });\n\n        result = await request;\n\n        if (!result.ok) {\n          console.error('Ошибка');\n\n          return;\n        }\n\n        json = await result.json();\n        const { status } = json;\n\n        if (status === 'OK') {\n          modalContainer.classList.add('display-none');\n          chat.renderChat();\n        }\n      } else {\n        const error = RenderModal.getError(inputModal);\n\n        if (error) {\n          showTooltip(error, inputModal);\n        }\n      }\n    });\n\n    const elementOnBlur = (e) => {\n      const el = e.target;\n\n      const error = RenderModal.getError(el);\n      if (error) {\n        showTooltip(error, el);\n      } else {\n        const currentErrorMessage = actualMessages.find((item) => item.name === el.name);\n\n        if (currentErrorMessage) {\n          this.tooltipFactory.removeTooltip(currentErrorMessage.id);\n        }\n      }\n\n      el.removeEventListener('blur', elementOnBlur);\n    };\n\n    inputModal.addEventListener('focus', () => {\n      inputModal.addEventListener('blur', elementOnBlur);\n    });\n  }\n\n  static getError(el) {\n    document.querySelector('.loadingio-spinner-spinner-ugc4sg2wum').remove();\n    const errors = {\n      nickname: {\n        valueMissing: 'Заполните, пожалуйста, поле \"Псевдоним\"',\n        customError: 'Пользователь с таким псевдонимом уже есть в чате, придумайте другой',\n      },\n    };\n\n    const errorKey = Object.keys(ValidityState.prototype).find((key) => {\n      if (!el.name) return null;\n      if (key === 'valid') return null;\n\n      if (el.validity[key]) console.log(key);\n\n      return el.validity[key];\n    });\n\n    if (!errorKey) return null;\n\n    return errors[el.name][errorKey];\n  }\n\n  static generationLoading(container) {\n    if (!document.querySelector('.loadingio-spinner-spinner-ugc4sg2wum')) {\n      const imageContainer = document.createElement('DIV');\n      const animation = document.createElement('DIV');\n\n      imageContainer.classList.add('loadingio-spinner-spinner-ugc4sg2wum');\n      animation.classList.add('ldio-7nr8cpu8w2k');\n\n      container.appendChild(imageContainer);\n      imageContainer.append(animation);\n      for (let i = 12; i !== 0; i -= 1) {\n        animation.append(document.createElement('DIV'));\n      }\n    }\n  }\n}\n","export default __webpack_public_path__ + \"assets/253f7b15dd6eb9ac37984ada287333f9.jpg\";","import RenderModal from './RenderModal';\n\nimport background from '../img/cell.jpg';\n\ndocument.querySelector('body').style.backgroundImage = `url(${background})`;\n\nconst container = document.querySelector('.app-container');\nconst render = new RenderModal(container);\n\nrender.enterUser();\n"],"names":["__webpack_require__","Chat","constructor","container","activeUser","this","renderConnectionUser","user","connectionContainer","document","querySelector","connectionRow","createElement","liPreview","connectionPreview","liUser","connectionUser","classList","add","textContent","window","onbeforeunload","async","query","encodeURIComponent","fetch","method","headers","appendChild","append","static","Array","from","querySelectorAll","find","item","closest","remove","chatContainer","chat","chatSend","chatMessage","placeholder","messaging","request","result","ok","console","error","json","forEach","nickname","gettingUsers","renderMessage","autor","text","boxMessage","information","message","dateCreate","date","Date","dateHours","getHours","dateMinutes","getMinutes","dateDay","getDate","dateMonth","getMonth","getFullYear","getCreationDate","eventSource","EventSource","addEventListener","e","log","data","req","JSON","parse","removeDisconnectionUser","ws","WebSocket","preventDefault","value","send","stringify","messages","Tooltip","_tooltips","showTooltip","element","tooltipElement","id","performance","now","push","body","right","top","getBoundingClientRect","style","left","offsetHeight","removeTooltip","tooltip","t","filter","removeAllTooltip","RenderModal","tooltipFactory","enterUser","modalContainer","titleModal","formModal","inputModal","buttonModal","setAttribute","name","setCustomValidity","actualMessages","el","generationLoading","checkValidity","status","renderChat","getError","elementOnBlur","target","currentErrorMessage","removeEventListener","errorKey","Object","keys","ValidityState","prototype","key","validity","valueMissing","customError","imageContainer","animation","i","backgroundImage","background"],"sourceRoot":""}